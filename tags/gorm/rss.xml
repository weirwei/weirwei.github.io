<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>gorm on 浩雨未倾</title><link>http://blog.weirwei.cn/tags/gorm/</link><description>Recent content in gorm on 浩雨未倾</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Wed, 27 Sep 2023 15:10:00 +0800</lastBuildDate><atom:link href="http://blog.weirwei.cn/tags/gorm/rss.xml" rel="self" type="application/rss+xml"/><item><title>Gorm 的黑魔法</title><link>http://blog.weirwei.cn/post/gorm_black_magic/</link><pubDate>Wed, 27 Sep 2023 15:10:00 +0800</pubDate><guid>http://blog.weirwei.cn/post/gorm_black_magic/</guid><description>&lt;blockquote>
&lt;p>小伙看到同事写的Gorm黑魔法，逐渐不淡定了。&lt;/p>
&lt;/blockquote>
&lt;p>开发过程中，看到同事的代码写了这么一段：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">db&lt;/span> = &lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">Session&lt;/span>(&lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">gorm&lt;/span>.&lt;span style="color:#a6e22e">Session&lt;/span>{&lt;span style="color:#a6e22e">Context&lt;/span>: &lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">Statement&lt;/span>.&lt;span style="color:#a6e22e">Context&lt;/span>}).&lt;span style="color:#a6e22e">FirstOrCreate&lt;/span>(&lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">entity&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">Error&lt;/span> &lt;span style="color:#f92672">!=&lt;/span>&lt;span style="color:#66d9ef">nil&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">components&lt;/span>.&lt;span style="color:#a6e22e">ErrorDbInsert&lt;/span>.&lt;span style="color:#a6e22e">WrapPrintf&lt;/span>(&lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">Error&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Insert error, entity:%s&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">utils&lt;/span>.&lt;span style="color:#a6e22e">ToJson&lt;/span>(&lt;span style="color:#a6e22e">entity&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">RowsAffected&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">components&lt;/span>.&lt;span style="color:#a6e22e">ErrorAlreadyExist&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>